@using Microsoft.AspNetCore.Routing
@using Nop.Plugin.Misc.Nexport.Models
@using Nop.Web.Framework.Models.DataTables

@model NexportProductGroupMembershipMappingListSearchModel

@await Html.PartialAsync("Table", new DataTablesModel
{
    Name = "product-mapping-group-memberships-grid",
    UrlRead = new DataUrl("GetProductGroupMembershipMappings", "NexportIntegration",
        new RouteValueDictionary {
            { "nexportProductMappingId", Model.NexportProductMappingId }
        }),
    UrlDelete = new DataUrl("DeleteGroupMembershipMapping", "NexportIntegration", null),
    Length = Model.PageSize,
    LengthMenu = Model.AvailablePageSizes,
    ColumnCollection = new List<ColumnProperty>
    {
        new ColumnProperty(nameof(NexportProductGroupMembershipMappingModel.NexportGroupId))
        {
            Title = "Group Id",
            Width = "250",
        },
        new ColumnProperty(nameof(NexportProductGroupMembershipMappingModel.Id))
        {
            Title = "Group",
            Width = "200",
            Render = new RenderCustom("renderGroupName")
        },
        new ColumnProperty(nameof(NexportProductGroupMembershipMappingModel.Id))
        {
            Width = "50",
            Render = new RenderButtonRemove(T("Admin.Common.Delete").Text),
            ClassName = NopColumnClassDefaults.Button,
            AutoWidth = false
        }
    }
})

<input type="submit" id="btnRefreshGroupMembershipMappings" style="display: none">

<script>
    function renderGroupName(data, type, row, meta) {
        var textRenderer = $.fn.dataTable.render.text().display;
        var groupName = row.NexportGroupName;
        var displayText = groupName;

        if (groupName !== null) {
            displayText += " - " + row.NexportGroupShortName;
        }

        return textRenderer(displayText);
    }
</script>
